{\centering
%
\SuperFont\MakeTextUppercase{Аннотация}\\
}
\vspace{32pt}
Данная работа ставит своей целью сделать краткий обзор понятия повторяемых сборок в сфере свободного программного обеспечения (ПО), шагов, предпринимаемых сообществом свободного ПО для их обеспечения и используемых для этого инструментах. В частности, более детально рассмотрен инструмент для сравнения результатов сборки -- diffoscope. В ходе работы было внесено несколько функциональных изменений в diffoscope с целью повышения удобства его использования для обеспечения репродуцируемых сборок.\\\\
Одним из главных достоинств свободного ПО является возможность изучать и модифицировать исходный код. Эта особенность также является гарантом безопасности и качества свободного ПО, так как любые недостатки или намеренные уязвимости в коде программы могут быть обнаружены любым её пользователем. Однако часто пользователи свободного ПО получают его уже в собранном виде. Чаще всего такое ПО распространяется в виде бинарных пакетов, доступных в репозиториях дистрибутива свободной операционной системы либо на сайте производителя ПО. Сборка такого пакета при этом зачастую производится на специально выделенных для этого компьютерах либо на компьютерах разработчиков ПО.\\\\
Наличие дополнительного этапа, неподконтрольного пользователю, между исходным кодом и конечным исполняемым файлом или библиотекой, открывает новый фронт для кибератак и место для потенциальных уязвимостей. Эти уязвимости могут выражаться в том, что какие-либо особенности в процессе сборки могут влиять на результат неочевидным способом, внося, возможно, не предусмотренные разработчиком изменения в работу программы.\\\\
Эту опасность можно было бы предотвратить, повторяя процесс сборки на различных компьютерах и сравнивая результат. Если у кого-то из <<сборщиков>> он получился отличным от остальных, это повод заподозрить какие-либо изменения в конфигурации сборки, возможно, вызванные кибератакой на компьютер, на котором она совершалась. Для того, чтобы такой способ работал, требуется гарантия того, что в нормальных условиях сборка ПО на разных компьютерах с разной конфигурацией из одного и того же исходного кода всегда давала один и тот же результат. Такое свойство ПО носит название повторяемых, или репродуцируемых сборок (reproducible builds).\\\\
Повторяемость сборки ПО является свойством этого ПО и находится в области ответственности его автора. Однако, так как в рамках работы мы говорим о свободном ПО, обеспечение повторяемых сборок различного ПО является интересом всего сообщества свободного ПО в целом. В частности, эта проблема важна для дистрибутивов свободных операционных систем (ОС), так как многие из них предоставляют собранные пакеты пользователям и поэтому компьютеры, на которых сборка этих пакетов происходит, являются очевидной целью для возможных кибератак. По этой причине представители различных проектов по созданию свободного ПО создали проект, призванный повышать видимость проблемы, а также обсуждать и предлагать конкретные шаги и инструменты для проверки и обеспечения повторяемых сборок для свободного ПО.\\\\
Общий алгоритм проверки ПО на репродуцируемость прост: достаточно произвести сборку два раза, внеся некоторые изменения в систему, из которой производится сборка. Такими изменениями могут быть смена языка ОС, даты и времени, текущей директории, имени пользователя и других параметров. Предполагается, что подобные факторы не должны влиять на процесс сборки. Результаты сборок должны быть идентичны побитово; обычно это проверяется сравнением их хэш-сумм. Если же результаты не совпадают, необходимо выяснить, какие именно отличия есть между собранными артефактами. Это нужно для определения настоящей причины неповторяемости сборки.\\\\
Для поиска различий между двумя файлами участниками проекта {Reproducible Builds} был создан инструмент diffoscope. Этот инструмент написан на Python 3 и распространяется под свободной лицензией GNU General Public License третьей или выше версии. Он имеет интерфейс командной строки, хотя существует и веб-версия. Его основная задача -- <<раскрывать>> файлы и рекурсивно сравнивать их содержимое. Он распаковывает архивы, дизасемблирует некоторые объектные файлы, конвертирует PDF-файлы в текст и изображения и применяет другие различные инструменты и приёмы для перевода файла в текстовый вид, удобный для восприятия человеком. После этого к полученным текстовым файлам применяется инструмент diff, выделяющий отличающиеся строки, и результат представляется в одном из поддерживаемых форматов: текст, HTML, JSON, Markdown или RST.\\\\
В рамках данной работы в diffoscope были внесены несколько функциональных изменений, призванных улучшить поддержку некоторых типов файлов, встречающихся при исследовании проблем повторяемости сборок, и улучшение читаемости результатов сравнения файлов. В частности, был внесен ряд улучшений в модуль сравнения APK (Android Package) файлов, файлов изображений, добавлено определение различий, состоящих только в порядке строк. Кроме этого, был проведен ряд экспериментов по реализации сравнения контейнеров разных типов и предложена работающая реализация для одного из самых часто встречающихся на практике вариантов такого сравнения.\\\\
Для APK-файлов были представлены изменения, позволяющие использовать информацию о пакете как о ZIP-архиве, для поиска различий в ZIP-метаданных, таких как степень сжатия и права доступа. Также была выделена обработка нескольких файлов, специфичных для этого формата файлов и для инструмента, используемого для его распаковки (apktool). Эти изменения позволяют скрыть повторяющиеся данные, а также данные, не относящиеся к содержанию файла, и сделать соответствующие файлы более доступными для поиска и интерпретации.\\\\
Для файлов изображений была добавлена возможность извлечения метаданных, таких как формат, палитра, количество цветов, информация о камере. Эта информация извлекается при помощи инструмента ImageMagick в текстовом виде и используется для сравнения файлов. Также для файлов изображений была добавлена генерация визуализации различий. Эта визуализация представляет из себя изображение, составленное из исходных таким образом, чтобы подчеркнуть видимые различия между ними. Данная информация может быть полезна при просмотре отчёта о различиях в HTML-формате, позволяя сразу увидеть различия в содержимом изображения.\\\\
Выявление различий, связанных с порядком строк в файлах, важно для идентификации проблем, связанным с недетерменированностью записи некоторой информации в процессе сборки. Теперь diffoscope проверяет наличие подобной ситуации при сравнении текстовых файлов, а также других форматов, которые могут рассматриваться как текстовые (например, HTML), и к полученной информации о различиях добавляется комментарий, сообщающий о том, что файлы отличаются только порядком следования строк.\\\\
Сравнение контейнеров разных типов представляет проблему, так как для таких файлов используются различные инструменты и извлекается различная информация. Помимо стандартизации обработки данных о контейнерах в подобных случаях, нужно было решить проблему поиска соответствий между файлами, содержащимися в контейнерах. Отдельную сложность составляют случаи, когда контейнеры имеют разные степени вложенности (так, например, получится при сравнении файлов типа ZIP и TAR.GZ -- часто используемых форматов в разработке ПО). В ходе работы было предложено изменение, позволяющее автоматически распаковывать контейнеры, гарантированно содержащие только один файл, и поиск различий уже с этим вложенным файлом.\\\\
В данной работе также рассмотрен процесс работы над повторяемыми сборками на примере Debian -- популярного дистрибутива Linux. Этот процесс включает в себя постоянное тестирование ПО, входящего в состав Debian, на повторяемость сборок. Для тех программ, для которых такое тестирование выявило проблемы с повторяемостью сборок, сохраняется и выкладывается в общий доступ отчёт о различиях, полученный при помощи diffiscope. Это позволяет разработчикам и майнтейнерам соответствующих пакетов, а также любому члену сообщества, ознакомиться с имеющимися проблемами и предложить способ их решения. Чаще всего представляется возможным выделить общие проблемы, типичные для нескольких пакетов; это может говорить о том, что проблема кроется не в самом ПО, а в инструментах, используемых для сборки. В таких случаях усилия по исправлению проблем также направляются на инструменты сборки; исправление ошибок в них помогает повлиять на состояние сразу всех программ, которые их используют.\\\\
К настоящему моменту участниками проекта классифицировано около ста различных проблем с повторяемостью сборок. Самые часто встречающиеся проблемы связаны с использованием текущей даты либо директории, из которой производится сборка. Для решения этих проблем были предложены специальные переменные окружения, позволяющие зафиксировать используемое значение. Изменения, использующие этот подход для даты сборки, были приняты многими разработчиками как отдельных пакетов, так и инструментов сборки.\\\\
Для успешного продолжения проекта и решения проблемы повторяемых сборок важно привлечь внимание к этой проблеме представителей как можно большего числа проектов по созданию свободного ПО. Это позволит улучшить кооперацию между разработчиками, находить общие решения для часто встречающихся проблем и обеспечить повторяемость сборок для большего числа свободных программных продуктов, тем самым улучшая контроль качества и безопасности в сфере свободного ПО.\\\\
